Вводное занятие Android OS
==========================
>**Note:**
>Это вводный урок в архитектуру ОС, тут я постарался дать дополнительную информацию вкратце. В следующих уроках текста будет меньше, ссылок будет больше.

###Архитектура ОС
Операционная система Android имеет три различных и сильно отделённых друг от друга уровня:

 - В основе лежит модифицированная и урезанная версия Linux.
 - Над уровнем Linux находится уровень инфраструктуры приложения, содержащий виртуальную машину Dalvik, веб-браузер, базу данных SQLite, некие инфраструктурные «костыли» и Java API.
 - И, наконец, уровень написанных в Google Android-приложений.
>Вообще говоря, они являются расширением уровня инфраструктуры, поскольку разработчик может использовать эти приложения или их части как строительные блоки для собственных разработок, например пользоваться контактами, делать фотографии через приложение камеры и т.д.

####Схема общей архитектуры Android OS
![Android OS Architecture](https://lh3.googleusercontent.com/oswRYXuGcB8YYvkxGLCIiBYOJIQvN9ZSMP2U0s6PGW2LySc5g6rlloZXXkmuWwmOk0UjvQ=w1366-h768-rw-no)

>**Ссылки для изучения**:
> http://www.c4learn.com/android/android-os-architecture/

###Dalvik 
<small>названа в честь рыбацкой деревни в Исландии</small>

>**Вся полезная информация тут**
>https://source.android.com/devices/tech/dalvik/dalvik-bytecode.html
>https://source.android.com/devices/tech/dalvik/dex-format.html
>https://source.android.com/devices/tech/dalvik/instruction-formats.html
>https://source.android.com/devices/tech/dalvik/constraints.html
>https://source.android.com/devices/tech/dalvik/configure.html
>https://source.android.com/devices/tech/dalvik/gc-debug.html

Dalvik VM отличается от других виртуальных Java-машин следующим:

* Она использует специальный формат DEX для хранения двоичных кодов, в противовес форматам JAR и Pack200, которые являются стандартом для других виртуальных Java-машинах. Компания Google заявила, что бинарники DEX меньше, чем JAR. 
* Dalvik VM оптимизирована для выполнения нескольких процессов одновременно.
* Dalvik VM использует архитектуру, основанную на регистрах против стековой архитектуры в других JVM, что приводит к увеличению скорости выполнения и уменьшению размеров бинарников. Она использует собственный набор инструкций (а не стандартный байткод JVM)
* Возможен запуск (если необходимо) нескольких независимых Android-приложений в одном процессе
* Выполнение приложения может охватывать несколько процессов Dalvik VM «естественным образом». Для поддержи этого добавлено:
   * Специальный механизм сериализации объектов, основанный на классах Parcel и Parcelable. Функционально преследуются те же цели, что и Java Serializable, но в результате данные имеют меньший объём и потенциально более терпимы к версионным изменениям классов.
   * Особый способ для выполнения вызовов между процессами (inter process calls, IPC), основный на Android Interface Definition Language (AIDL).
* До Android 2.2 Dalvik VM не поддерживала JIT<sup id="jit-b">[1](#jit)</sup>-компиляцию, что было серьёзным ударом по производительности. Начиная с версии 2.2, скорость выполнения часто используемых приложений, запускаемых повторно, заметно возросла.

Начиная с Android OS 5 была анонсирована "новая" виртуальная машина *ART*. 
Основные отличия описаны [тут](https://source.android.com/devices/tech/dalvik/#features). Главное отличие в том, что вместо JIT используется AOT<sup id="aot-b">[1](#aot)</sup>. В целом, это тот же Dalvik, но с AOT-компиляцией. 

Домашнее задание
------
1. Найти примеры байткода Java и Dalvik. Посмотреть.
2. Узнать, что такое *стековая* и *регистровая* архитектуры, рассказать мне при возможности.

-----
<a id="jit"></a>JIT -- [*Just-in-time compilation*](https://en.wikipedia.org/wiki/Just-in-time_compilation) [↩](#jit-b)
<a id="aot"></a>AOT -- [*Ahead-of-time compilation*](https://en.wikipedia.org/wiki/Ahead-of-time_compilation) -- компиляция происходит при установке приложения или при первом запуске ОС, если приложение встроенное. [↩](#aot-b)